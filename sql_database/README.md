# Содержание

- [Для чего нужна база данных](#task1)
- [Как организована база данных](#task2)
- [Создание базы данных](#task3)
- [Выгрузка информации и построение пайплайна (конвейера) данных](#task4)

# Для чего нужна база данных <a class="anchor" id="task1"></a>
При реализации проекта одной из важных задач стоящих перед нами было обеспечить масштабируемость проекта. Проект должен иметь возможность обучаться на большом количестве данных, значительно превосходящем объем предоставленный для соревнования. Поэтому проекту необходима база данных которая позволит хранить большой массив информации и при необходимости выгружать его для обучения модели. Также это позволит фильтровать данные при необходимости.
Отдельно отметим, что в рамках хакатона не хватило времени чтобы поднять базу данных и продемонстрировать ее работоспособность, однако мы разбработали прототип решения.

# Как организована база данных <a class="anchor" id="task2"></a>
Изначально мы не ограничивались в выборе определенной СУБД, поэтому скрипты представленные в этом решении не привязаны к синтаксису определенной СУБД, так как предполагаетсячто это должна быть одна из СУБД с открытым исходным кодом. 
В решении представлена схема базы данных описывающая основные таблицы  и их отноошения. За основу была выбрана реляционная модель базы данных, которая была нормализована и приведена к 3-ей форме. Схему базы данных можно найти в файле schema_database.png.
![schema_database](schema_database.png 'Схема базы данных')

# Создание базы данных <a class="anchor" id="task3"></a>
В папке представлено 2 запроса к базе данных.
- **[create_database.sql](https://github.com/Sekai-no-uragawa/aihack/blob/main/sql_database/create_database.sql)** - запрос для создания базы данных согласно предложенной схеме.
- **[query_data_for_model.sql](https://github.com/Sekai-no-uragawa/aihack/blob/main/sql_database/query_data_for_model.sql)** - запрос который позволяет получить выгрузку из базы данных для предложенной модели.

# Выгрузка информации и построение пайплайна (конвейера) данных <a class="anchor" id="task4"></a>
Для выгрузки данных из БД предусмотрен python-скрипт. Несмотря на то, что наше решение будет работать со всеми СУБД основанных на языке запросов SQL мы ориентиривались на PostgreSQL. Поэтому скрипт на Python обращается именно к этой базе данных. Однако, данное решение очень гибкое и в короткие может быть переделано под любую базу данных.
Скрипт предполагает первую ступень пайплайна данных. Он позволяет обратиться к БД, выгрузить данные и сохранить их в том месте где к ним сможет обратиться модель для переобучения. Скрипт должен отрабатывать с заданной периодичностью и обновлять данные для модели. Это одна из ступеней переобучения модели, т.к. именно новые данные позволят модели становится точнее и быть актуальной.
- **[sql_pipeline.py](https://github.com/Sekai-no-uragawa/aihack/blob/main/sql_database/sql_pipeline.py)** - скрипт который подгружает запрос [query_data_for_model.sql](https://github.com/Sekai-no-uragawa/aihack/blob/main/sql_database/query_data_for_model.sql), обращается к базе данных и выгружает данные. 

У скрипта также есть возможность задавать дату от которой необходимо выгрузить данные. Это решение реализовано для поддержания актуальности данных в случае если изменится законодательство и модель нужно будет обучать на решениях проверяющих от даты изменения законодательства.
